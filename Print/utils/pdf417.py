# -*- coding: iso-8859-1 -*-
# PDF417 utilities
#
# Version: 1.0
# Author: Jan KÂŠrrman

import sys, re, math

def textcodes(text):
    codewords = []
    while text:
        codewords.append(30*text[0] + text[1])
        text = text[2:]
    return codewords

def ceil(val):
    return int(math.ceil(val))

ALPHA = 1
LOWER = 2
MIXED = 3
PUNCTUATION = 4
BYTE = 5
NUMERIC = 6
TEXTLATCH = 900
BYTELATCH = 901
NUMERICLATCH = 902
BYTESHIFT = 913
BYTELATCH2 = 924

codes = [
 ["d00i", "p00b", "600t"], ["j00m", "u00f", "d00w"], ["p00q", "j015", "001o"],
 ["d01h", "p01a", "601s"], ["j01l", "u01e", "d01v"], ["p01p", "j024", "002n"],
 ["602c", "p028", "602r"], ["d02g", "u02d", "d02u"], ["603b", "j033", "003m"],
 ["0045", "p037", "603q"], ["604a", "j042", "004l"], ["0054", "p046", "u063"],
 ["606i", "j051", "006t"], ["d06m", "j06b", "606w"], ["j06q", "p06f", "u072"],
 ["607h", "u06j", "007s"], ["d07l", "d075", "607v"], ["j07p", "j07a", "u081"],
 ["008c", "p07e", "008r"], ["608g", "d084", "608u"], ["00ab", "j088", "u0a0"],
 ["00di", "p08d", "00aq"], ["60dm", "d0a3", "p0d3"], ["d0dq", "j0a7", "u0d7"],
 ["00eh", "d0b2", "00dw"], ["60el", "j0b6", "p0e2"], ["d0ep", "d0c1", "u0e6"],
 ["00fg", "d0db", "00ev"], ["60fk", "j0df", "p0f1"], ["00jm", "p0dj", "00fu"],
 ["60jq", "60e5", "p0g0"], ["00kl", "d0ea", "j0j3"], ["60kp", "j0ee", "p0j7"],
 ["00pq", "60f4", "j0k2"], ["p0u0", "d0f8", "p0k6"], ["d10h", "j0fd", "j0l1"],
 ["j10l", "60g3", "j0m0"], ["p10p", "d0g7", "d0p3"], ["611c", "60h2", "j0p7"],
 ["d11g", "d0h6", "d0q2"], ["j11k", "60i1", "j0q6"], ["612b", "60jb", "d0r1"],
 ["d12f", "d0jf", "d0s0"], ["0135", "j0jj", "60u3"], ["613a", "00k5", "d0u7"],
 ["d13e", "60ka", "60v2"], ["0144", "d0ke", "d0v6"], ["6148", "00l4", "60w1"],
 ["0153", "60l8", "010o"], ["616h", "d0ld", "610s"], ["d16l", "00m3", "d10v"],
 ["j16p", "60m7", "011n"], ["017c", "00n2", "611r"], ["617g", "60n6", "d11u"],
 ["d17k", "00pb", "012m"], ["018b", "60pf", "612q"], ["618f", "d0pj", "013l"],
 ["d18j", "00qa", "613p"], ["01aa", "60qe", "014k"], ["61ae", "00r8", "u162"],
 ["01dh", "60rd", "016s"], ["61dl", "00s7", "616v"], ["d1dp", "00uf", "u171"],
 ["01eg", "60uj", "017r"], ["61ek", "00ve", "617u"], ["01ff", "00wd", "u180"],
 ["61fj", "j105", "018q"], ["01jl", "p10a", "01ap"], ["61jp", "u10e", "p1d2"],
 ["01kk", "j114", "u1d6"], ["01lj", "p118", "01dv"], ["620c", "u11d", "p1e1"],
 ["d20g", "j123", "01eu"], ["j20k", "p127", "p1f0"], ["621b", "j132", "j1j2"],
 ["d21f", "p136", "p1j6"], ["j21j", "j141", "j1k1"], ["0225", "j150", "j1l0"],
 ["622a", "d165", "d1p2"], ["d22e", "j16a", "j1p6"], ["0234", "p16e", "d1q1"],
 ["6238", "d174", "d1r0"], ["0243", "j178", "61u2"], ["0252", "p17d", "d1u6"],
 ["026c", "d183", "61v1"], ["626g", "j187", "61w0"], ["d26k", "d1a2", "020n"],
 ["027b", "j1a6", "620r"], ["627f", "d1b1", "d20u"], ["d27j", "d1c0", "021m"],
 ["028a", "61d5", "621q"], ["628e", "d1da", "022l"], ["02a8", "j1de", "622p"],
 ["02b7", "61e4", "023k"], ["02dg", "d1e8", "024j"], ["62dk", "j1ed", "u261"],
 ["02ef", "61f3", "026r"], ["62ej", "d1f7", "626u"], ["02fe", "61g2", "u270"],
 ["02jk", "d1g6", "027q"], ["630b", "61h1", "028p"], ["d30f", "61i0", "p2d1"],
 ["j30j", "01j5", "02du"], ["0315", "61ja", "p2e0"], ["631a", "d1je", "j2j1"],
 ["d31e", "01k4", "j2k0"], ["0324", "61k8", "d2p1"], ["6328", "d1kd", "d2q0"],
 ["d32d", "01l3", "62u1"], ["0333", "61l7", "62v0"], ["6337", "01m2", "030m"],
 ["0342", "61m6", "630q"], ["6346", "01n1", "031l"], ["036b", "01pa", "631p"],
 ["636f", "61pe", "032k"], ["d36j", "01q8", "033j"], ["037a", "61qd", "u360"],
 ["637e", "01r7", "036q"], ["0388", "01s6", "037p"], ["638d", "01ue", "p3d0"],
 ["03a7", "01vd", "j3j0"], ["03b6", "j204", "d3p0"], ["63dj", "p208", "040l"],
 ["03fd", "u20d", "640p"], ["0405", "j213", "041k"], ["640a", "p217", "042j"],
 ["d40e", "j222", "046p"], ["0414", "p226", "050k"], ["6418", "j231", "051j"],
 ["d41d", "j240", "100o"], ["0423", "d264", "700s"], ["6427", "j268", "e00v"],
 ["0432", "p26d", "101n"], ["6436", "d273", "701r"], ["0441", "j277", "e01u"],
 ["046a", "d282", "102m"], ["0478", "j286", "702q"], ["0487", "d2a1", "103l"],
 ["0504", "d2b0", "703p"], ["d50d", "62d4", "104k"], ["6517", "d2d8", "v062"],
 ["6526", "j2dd", "106s"], ["0540", "62e3", "706v"], ["e00h", "d2e7", "v071"],
 ["k00l", "62f2", "107r"], ["q00p", "d2f6", "707u"], ["701c", "62g1", "v080"],
 ["e01g", "62h0", "108q"], ["k01k", "02j4", "10ap"], ["702b", "62j8", "q0d2"],
 ["e02f", "d2jd", "v0d6"], ["k02j", "02k3", "10dv"], ["1035", "62k7", "q0e1"],
 ["703a", "02l2", "10eu"], ["1044", "62l6", "q0f0"], ["706h", "02m1", "k0j2"],
 ["e06l", "02n0", "q0j6"], ["k06p", "02p8", "k0k1"], ["107c", "62pd", "k0l0"],
 ["707g", "02q7", "e0p2"], ["e07k", "02r6", "k0p6"], ["108b", "02ud", "e0q1"],
 ["708f", "j303", "e0r0"], ["10aa", "p307", "70u2"], ["10b8", "j312", "e0u6"],
 ["10dh", "p316", "70v1"], ["70dl", "j321", "70w0"], ["e0dp", "j330", "660n"],
 ["10eg", "d363", "d60r"], ["70ek", "j367", "j60u"], ["10ff", "d372", "061i"],
 ["10ge", "j376", "661m"], ["10jl", "d381", "d61q"], ["70jp", "d3a0", "062h"],
 ["10kk", "63d3", "662l"], ["10pp", "d3d7", "d62p"], ["d60c", "63e2", "063g"],
 ["j60g", "d3e6", "663k"], ["p60k", "63f1", "064f"], ["d61b", "63g0", "664j"],
 ["j61f", "03j3", "065e"], ["p61j", "63j7", "110n"], ["6625", "03k2", "710r"],
 ["d62a", "63k6", "e10u"], ["j62e", "03l1", "066n"], ["6634", "03m0", "111m"],
 ["d638", "03p7", "711q"], ["j63d", "03q6", "067m"], ["6643", "j402", "667q"],
 ["d647", "p406", "712p"], ["710c", "j411", "068l"], ["e10g", "j420", "113k"],
 ["k10k", "d462", "06ak"], ["666c", "j466", "114j"], ["711b", "d471", "06bj"],
 ["e11f", "d480", "v161"], ["k11j", "64d2", "116r"], ["667b", "d4d6", "716u"],
 ["d67f", "64e1", "u6d1"], ["j67j", "64f0", "v170"], ["0685", "04j2", "06dr"],
 ["1134", "64j6", "117q"], ["7138", "04k1", "u6e0"], ["e13d", "04l0", "06eq"],
 ["06a4", "j501", "118p"], ["66a8", "j510", "06fp"], ["06b3", "d561", "q1d1"],
 ["116c", "d570", "11du"], ["716g", "65d1", "p6j1"], ["e16k", "65e0", "q1e0"],
 ["06dc", "k005", "06ju"], ["117b", "q00a", "p6k0"], ["717f", "v00e", "k1j1"],
 ["e17j", "k014", "j6p1"], ["06eb", "q018", "k1k0"], ["66ef", "v01d", "j6q0"],
 ["d6ej", "k023", "e1p1"], ["06fa", "q027", "d6u1"], ["11a8", "k032", "e1q0"],
 ["06g8", "q036", "d6v0"], ["11dg", "k041", "71u1"], ["71dk", "k050", "71v0"],
 ["06jg", "e065", "070i"], ["11ef", "k06a", "670m"], ["71ej", "q06e", "d70q"],
 ["06kf", "e074", "071h"], ["66kj", "k078", "671l"], ["06le", "q07d", "d71p"],
 ["11jk", "e083", "072g"], ["06pk", "k087", "672k"], ["11kj", "e0a2", "073f"],
 ["06qj", "k0a6", "673j"], ["d70b", "e0b1", "074e"], ["j70f", "e0c0", "075d"],
 ["p70j", "70d5", "120m"], ["6715", "e0da", "720q"], ["d71a", "k0de", "076m"],
 ["j71e", "70e4", "121l"], ["6724", "e0e8", "721p"], ["d728", "k0ed", "077l"],
 ["j72d", "70f3", "677p"], ["6733", "e0f7", "078k"], ["d737", "70g2", "123j"],
 ["6742", "e0g6", "07aj"], ["6751", "70h1", "v260"], ["720b", "70i0", "126q"],
 ["e20f", "10j5", "u7d0"], ["k20j", "70ja", "07dq"], ["676b", "e0je", "127p"],
 ["721a", "10k4", "07ep"], ["e21e", "70k8", "q2d0"], ["0775", "e0kd", "p7j0"],
 ["1224", "10l3", "k2j0"], ["d77e", "70l7", "j7p0"], ["e22d", "10m2", "e2p0"],
 ["0784", "70m6", "d7u0"], ["1233", "10n1", "72u0"], ["7237", "10pa", "080h"],
 ["07a3", "70pe", "680l"], ["67a7", "10q8", "d80p"], ["7246", "70qd", "081g"],
 ["1251", "10r7", "681k"], ["126b", "10s6", "082f"], ["726f", "10ue", "682j"],
 ["e26j", "10vd", "083e"], ["07db", "p604", "084d"], ["127a", "u608", "130l"],
 ["727e", "060x", "730p"], ["07ea", "p613", "086l"], ["67ee", "u617", "131k"],
 ["728d", "061w", "087k"], ["07f8", "p622", "132j"], ["12a7", "u626", "088j"],
 ["12b6", "062v", "136p"], ["12df", "p631", "08dp"], ["72dj", "p640", "0a0g"],
 ["07jf", "k104", "6a0k"], ["12ee", "q108", "0a1f"], ["07ke", "v10d", "6a1j"],
 ["12fd", "j664", "0a2e"], ["07ld", "k113", "0a3d"], ["07pj", "u66d", "140k"],
 ["6805", "j673", "0a6k"], ["d80a", "p677", "141j"], ["j80e", "q126", "0a7j"],
 ["6814", "j682", "0b0f"], ["d818", "k131", "6b0j"], ["j81d", "j6a1", "0b1e"],
 ["6823", "k140", "0b2d"], ["d827", "j6b0", "150j"], ["6832", "e164", "0b6j"],
 ["d836", "k168", "0c0e"], ["6841", "q16d", "0c1d"], ["6850", "d6d4", "200n"],
 ["1305", "e173", "800r"], ["730a", "k177", "f00u"], ["e30e", "d6e3", "201m"],
 ["0865", "j6e7", "801q"], ["1314", "k186", "202l"], ["7318", "d6f2", "802p"],
 ["e31d", "e1a1", "203k"], ["0874", "d6g1", "204j"], ["6878", "e1b0", "w061"],
 ["d87d", "d6h0", "206r"], ["0883", "71d4", "806u"], ["1332", "e1d8", "w070"],
 ["7336", "k1dd", "207q"], ["08a2", "66j4", "208p"], ["68a6", "71e3", "r0d1"],
 ["08b1", "e1e7", "20du"], ["136a", "66k3", "r0e0"], ["736e", "d6k7", "l0j1"],
 ["08da", "e1f6", "l0k0"], ["1378", "66l2", "f0p1"], ["737d", "71g1", "f0q0"],
 ["08e8", "66m1", "80u1"], ["68ed", "71h0", "80v0"], ["08f7", "66n0", "160i"],
 ["13a6", "11j4", "760m"], ["08g6", "71j8", "e60q"], ["08je", "e1jd", "161h"],
 ["08kd", "06p4", "761l"], ["6a04", "11k3", "e61p"], ["da08", "71k7", "162g"],
 ["ja0d", "06q3", "762k"], ["6a13", "66q7", "163f"], ["da17", "71l6", "763j"],
 ["6a22", "06r2", "164e"], ["da26", "11m1", "165d"], ["6a31", "06s1", "210m"],
 ["6a40", "11n0", "810q"], ["1404", "11p8", "166m"], ["7408", "71pd", "211l"],
 ["e40d", "06u8", "811p"], ["0a64", "11q7", "167l"], ["1413", "06v7", "767p"],
 ["7417", "11r6", "168k"], ["0a73", "06w6", "213j"], ["6a77", "11ud", "16aj"],
 ["7426", "p703", "w160"], ["0a82", "u707", "216q"], ["1431", "070w", "v6d0"],
 ["0aa1", "p712", "16dq"], ["1440", "u716", "217p"], ["1468", "071v", "16ep"],
 ["0ad8", "p721", "r1d0"], ["0ae7", "072u", "q6j0"], ["0af6", "p730", "l1j0"],
 ["db07", "k203", "k6p0"], ["db16", "q207", "f1p0"], ["6b30", "j763", "e6u0"],
 ["7507", "k212", "81u0"], ["1512", "q216", "6d0h"], ["0b72", "j772", "dd0l"],
 ["0b81", "p776", "jd0p"], ["0ba0", "j781", "0d1c"], ["800c", "k230", "6d1g"],
 ["f00g", "j7a0", "dd1k"], ["l00k", "e263", "0d2b"], ["801b", "k267", "6d2f"],
 ["f01f", "d7d3", "dd2j"], ["2025", "e272", "0d3a"], ["802a", "k276", "6d3e"],
 ["f02e", "d7e2", "0d48"], ["2034", "j7e6", "6d4d"], ["8038", "d7f1", "0d57"],
 ["2043", "e2a0", "170h"], ["2052", "d7g0", "770l"], ["206c", "72d3", "e70p"],
 ["806g", "e2d7", "0d6h"], ["f06k", "67j3", "171g"], ["207b", "72e2", "771k"],
 ["807f", "e2e6", "0d7g"], ["f07j", "67k2", "6d7k"], ["208a", "d7k6", "772j"],
 ["808e", "67l1", "0d8f"], ["20a8", "72g0", "173e"], ["20b7", "67m0", "0dae"],
 ["20dg", "12j3", "174d"], ["80dk", "72j7", "0dbd"], ["20ef", "07p3", "220l"],
 ["80ej", "12k2", "820p"], ["20fe", "72k6", "176l"], ["20jk", "07q2", "221k"],
 ["20kj", "67q6", "0ddl"], ["e60b", "07r1", "177k"], ["k60f", "12m0", "222j"],
 ["q60j", "07s0", "0dek"], ["7615", "12p7", "178j"], ["e61a", "07u7", "0dfj"],
 ["k61e", "12q6", "226p"], ["7624", "07v6", "17dp"], ["e628", "p802", "0djp"],
 ["k62d", "u806", "0e0c"], ["7633", "080v", "6e0g"], ["e637", "p811", "de0k"],
 ["7642", "081u", "0e1b"], ["e646", "p820", "6e1f"], ["810b", "k302", "de1j"],
 ["f10f", "q306", "0e2a"], ["l10j", "j862", "6e2e"], ["766b", "p866", "0e38"],
 ["811a", "j871", "6e3d"], ["f11e", "k320", "0e47"], ["1675", "j880", "0e56"],
 ["2124", "e362", "180g"], ["e67e", "k366", "780k"], ["f12d", "d8d2", "0e6g"],
 ["1684", "e371", "181f"], ["7688", "d8e1", "781j"], ["8137", "e380", "0e7f"],
 ["16a3", "d8f0", "6e7j"], ["2142", "73d2", "0e8e"], ["16b2", "e3d6", "183d"],
 ["216b", "68j2", "0ead"], ["816f", "d8j6", "230k"], ["f16j", "68k1", "186k"],
 ["16db", "73f0", "231j"], ["217a", "68l0", "0edk"], ["e6dj", "13j2", "187j"],
 ["16ea", "73j6", "0eej"], ["76ee", "08p2", "0f0b"], ["818d", "13k1", "6f0f"],
 ["16f8", "08q1", "df0j"], ["21a7", "13l0", "0f1a"], ["16g7", "08r0", "6f1e"],
 ["21df", "13p6", "0f28"], ["81dj", "08u6", "6f2d"], ["16jf", "pa01", "0f37"],
 ["21ee", "0a0u", "0f46"], ["16ke", "pa10", "1a0f"], ["21fd", "k401", "7a0j"],
 ["21jj", "ja61", "0f6f"], ["16pj", "k410", "1a1e"], ["dd05", "ja70", "0f7e"],
 ["jd0a", "e461", "1a2d"], ["pd0e", "dad1", "0f8d"], ["dd14", "e470", "240j"],
 ["jd18", "dae0", "1a6j"], ["pd1d", "74d1", "0fdj"], ["dd23", "6aj1", "0g0a"],
 ["jd27", "74e0", "6g0e"], ["dd32", "6ak0", "0g18"], ["jd36", "14j1", "6g1d"],
 ["dd41", "0ap1", "0g27"], ["7705", "14k0", "0g36"], ["e70a", "0aq0", "1b0e"],
 ["k70e", "pb00", "0g6e"], ["6d65", "k500", "1b1d"], ["7714", "jb60", "0g7d"],
 ["jd6e", "e560", "0h08"], ["k71d", "dbd0", "6h0d"], ["6d74", "75d0", "0h17"],
 ["dd78", "6bj0", "0h26"], ["jd7d", "l004", "1c0d"], ["6d83", "r008", "0h6d"],
 ["7732", "w00d", "0i07"], ["e736", "l013", "0i16"], ["6da2", "r017", "300m"],
 ["dda6", "l022", "a00q"], ["7750", "r026", "301l"], ["2205", "l031", "a01p"],
 ["820a", "l040", "302k"], ["f20e", "f064", "303j"], ["1765", "l068", "306q"],
 ["2214", "r06d", "307p"], ["8218", "f073", "s0d0"], ["f21d", "l077", "m0j0"],
 ["0dd5", "f082", "g0p0"], ["1774", "l086", "a0u0"], ["7778", "f0a1", "260h"],
 ["e77d", "f0b0", "860l"], ["0de4", "80d4", "f60p"], ["6de8", "f0d8", "261g"],
 ["dded", "l0dd", "861k"], ["8236", "80e3", "262f"], ["0df3", "f0e7", "862j"],
 ["17a2", "80f2", "263e"], ["77a6", "f0f6", "264d"], ["0dg2", "80g1", "310l"],
 ["2250", "80h0", "a10p"], ["226a", "20j4", "266l"], ["826e", "80j8", "311k"],
 ["17da", "f0jd", "267k"], ["2278", "20k3", "312j"], ["827d", "80k7", "268j"],
 ["0dja", "20l2", "316p"], ["17e8", "80l6", "26dp"], ["77ed", "20m1", "1d0c"],
 ["0dk8", "20n0", "7d0g"], ["6dkd", "20p8", "ed0k"], ["22a6", "80pd", "1d1b"],
 ["17g6", "20q7", "7d1f"], ["22de", "20r6", "ed1j"], ["17je", "20ud", "1d2a"],
 ["22ed", "q603", "7d2e"], ["0dpe", "v607", "1d38"], ["17kd", "160w", "7d3d"],
 ["de04", "q612", "1d47"], ["je08", "v616", "1d56"], ["pe0d", "161v", "270g"],
 ["de13", "q621", "870k"], ["je17", "162u", "1d6g"], ["de22", "q630", "271f"],
 ["je26", "l103", "871j"], ["de31", "r107", "1d7f"], ["de40", "k663", "272e"],
 ["7804", "l112", "1d8e"], ["e808", "r116", "273d"], ["k80d", "k672", "1dad"],
 ["6e64", "q676", "320k"], ["7813", "k681", "276k"], ["je6d", "l130", "321j"],
 ["6e73", "k6a0", "1ddk"], ["de77", "f163", "277j"], ["e826", "l167", "1dej"],
 ["6e82", "e6d3", "6j0b"], ["7831", "f172", "dj0f"], ["6ea1", "l176", "jj0j"],
 ["7840", "e6e2", "0j15"], ["6eb0", "k6e6", "6j1a"], ["2304", "e6f1", "dj1e"],
 ["8308", "f1a0", "0j24"], ["f30d", "e6g0", "6j28"], ["1864", "81d3", "dj2d"],
 ["2313", "f1d7", "0j33"], ["8317", "76j3", "6j37"], ["0ed4", "81e2", "0j42"],
 ["1873", "f1e6", "6j46"], ["7877", "76k2", "0j51"], ["8326", "e6k6", "1e0b"],
 ["0ee3", "76l1", "7e0f"], ["6ee7", "81g0", "ee0j"], ["2331", "76m0", "0j6b"],
 ["0ef2", "21j3", "1e1a"], ["18a1", "81j7", "7e1e"], ["2340", "16p3", "0j7a"],
 ["18b0", "21k2", "6j7e"], ["2368", "81k6", "7e2d"], ["836d", "16q2", "0j88"],
 ["18d8", "76q6", "1e37"], ["2377", "16r1", "0ja7"], ["0ej8", "21m0", "1e46"],
 ["18e7", "16s0", "0jb6"], ["2386", "21p7", "280f"], ["0ek7", "16u7", "880j"],
 ["18f6", "21q6", "1e6f"], ["23dd", "16v6", "281e"], ["0epd", "ud02", "0jdf"],
 ["df03", "0d0s", "1e7e"], ["jf07", "6d0v", "282d"], ["df12", "ud11", "0jee"],
 ["jf16", "0d1r", "1e8d"], ["df21", "6d1u", "0jfd"], ["df30", "ud20", "330j"],
 ["7a03", "0d2q", "286j"], ["ea07", "0d3p", "1edj"], ["6f63", "q702", "0jjj"],
 ["7a12", "v706", "0k05"], ["ea16", "170v", "6k0a"], ["6f72", "pd62", "dk0e"],
 ["df76", "ud66", "0k14"], ["6f81", "0d6v", "6k18"], ["7a30", "171u", "dk1d"],
 ["6fa0", "pd71", "0k23"], ["2403", "q720", "6k27"], ["8407", "0d7u", "0k32"],
 ["1a63", "pd80", "6k36"], ["2412", "l202", "0k41"], ["8416", "r206", "0k50"],
 ["0fd3", "k762", "1f0a"], ["1a72", "l211", "7f0e"], ["7a76", "jdd2", "0k6a"],
 ["0fe2", "pdd6", "1f18"], ["6fe6", "l220", "7f1d"], ["2430", "jde1", "0k78"],
 ["0ff1", "k780", "6k7d"], ["1aa0", "jdf0", "0k87"], ["0fg0", "f262", "1f36"],
 ["1ad7", "l266", "0ka6"], ["0fj7", "e7d2", "2a0e"], ["0fk6", "f271", "1f6e"],
 ["jg06", "ddj2", "2a1d"], ["dg20", "e7e1", "0kde"], ["eb06", "f280", "1f7d"],
 ["7b11", "ddk1", "0ked"], ["7b20", "e7f0", "0l04"], ["2502", "ddl0", "6l08"],
 ["1b62", "82d2", "dl0d"], ["0gd2", "f2d6", "0l13"], ["2520", "77j2", "6l17"],
 ["1b80", "82e1", "0l22"], ["a00b", "6dp2", "6l26"], ["3015", "77k1", "0l31"],
 ["a01a", "82f0", "0l40"], ["3024", "6dq1", "1g08"], ["a028", "77l0", "7g0d"],
 ["g02d", "6dr0", "0l68"], ["3033", "22j2", "1g17"], ["a037", "82j6", "0l77"],
 ["3042", "17p2", "1g26"], ["a046", "22k1", "0l86"], ["306b", "0du2", "2b0d"],
 ["a06f", "17q1", "1g6d"], ["g06j", "22l0", "0ldd"], ["307a", "0dv1", "0m03"],
 ["a07e", "17r0", "6m07"], ["3088", "0dw0", "0m12"], ["a08d", "22p6", "6m16"],
 ["30a7", "17u6", "0m21"], ["30b6", "ue01", "0m30"], ["30df", "0e0r", "1h07"],
 ["a0dj", "6e0u", "0m67"], ["30ee", "ue10", "1h16"], ["30fd", "0e1q", "0m76"],
 ["30jj", "0e2p", "0n02"], ["8605", "q801", "6n06"], ["f60a", "180u", "0n11"],
 ["l60e", "pe61", "0n20"], ["8614", "q810", "1i06"], ["f618", "0e6u", "0n66"],
 ["8623", "pe70", "400l"], ["f627", "l301", "b00p"], ["8632", "k861", "401k"],
 ["f636", "l310", "402j"], ["8641", "jed1", "406p"], ["3105", "k870", "360g"],
 ["a10a", "jee0", "a60k"], ["g10e", "f361", "361f"], ["2665", "e8d1", "a61j"],
 ["3114", "f370", "362e"], ["f66e", "dej1", "363d"], ["g11d", "e8e0", "410k"],
 ["2674", "dek0", "366k"], ["8678", "83d1", "411j"], ["f67d", "78j1", "367j"],
 ["2683", "83e0", "2d0b"], ["3132", "6ep1", "8d0f"], ["a136", "78k0", "fd0j"],
 ["26a2", "6eq0", "2d1a"], ["86a6", "23j1", "8d1e"], ["3150", "18p1", "2d28"],
 ["316a", "23k0", "8d2d"], ["a16e", "0eu1", "2d37"], ["26da", "18q0", "2d46"],
 ["3178", "0ev0", "370f"], ["a17d", "uf00", "a70j"], ["26e8", "0f0q", "2d6f"],
 ["86ed", "0f1p", "371e"], ["26f7", "qa00", "2d7e"], ["31a6", "pf60", "372d"],
 ["31de", "l400", "2d8d"], ["26je", "ka60", "420j"], ["31ed", "jfd0", "376j"],
 ["26kd", "f460", "2ddj"], ["ed04", "ead0", "1j05"], ["kd08", "dfj0", "7j0a"],
 ["qd0d", "84d0", "ej0e"], ["ed13", "7aj0", "1j14"], ["kd17", "6fp0", "7j18"],
 ["ed22", "24j0", "ej1d"], ["kd26", "1ap0", "1j23"], ["ed31", "0fu0", "7j27"],
 ["ed40", "0g0p", "1j32"], ["8704", "m003", "7j36"], ["f708", "s007", "1j41"],
 ["7d64", "m012", "1j50"], ["8713", "s016", "2e0a"], ["f717", "m021", "8e0e"],
 ["7d73", "m030", "1j6a"], ["ed77", "g063", "2e18"], ["f726", "m067", "8e1d"],
 ["7d82", "g072", "1j78"], ["8731", "m076", "7j7d"], ["7da1", "g081", "1j87"],
 ["8740", "g0a0", "2e36"], ["7db0", "a0d3", "1ja6"], ["3204", "g0d7", "380e"],
 ["a208", "a0e2", "2e6e"], ["2764", "g0e6", "381d"], ["3213", "a0f1", "1jde"],
 ["f76d", "a0g0", "2e7d"], ["1dd4", "30j3", "1jed"], ["2773", "a0j7", "6p04"],
 ["8777", "30k2", "dp08"], ["a226", "a0k6", "jp0d"], ["1de3", "30l1", "6p13"],
 ["7de7", "30m0", "dp17"], ["3231", "30p7", "6p22"], ["1df2", "30q6", "dp26"],
 ["27a1", "r602", "6p31"], ["3240", "w606", "6p40"], ["27b0", "260v", "1k04"],
 ["3268", "r611", "7k08"], ["a26d", "261u", "ek0d"], ["27d8", "r620", "0p64"],
 ["3277", "m102", "1k13"], ["1dj8", "s106", "7k17"], ["27e7", "l662", "0p73"],
 ["3286", "m111", "6p77"], ["1dk7", "l671", "7k26"], ["27f6", "m120", "0p82"],
 ["32dd", "l680", "1k31"], ["27jd", "g162", "0pa1"], ["1dpd", "m166", "1k40"],
 ["jj03", "f6d2", "0pb0"], ["pj07", "g171", "2f08"], ["jj12", "f6e1", "8f0d"],
 ["pj16", "g180", "1k68"], ["jj21", "f6f0", "2f17"], ["jj30", "a1d2", "0pd8"],
 ["ee03", "g1d6", "1k77"], ["ke07", "86j2", "2f26"], ["dj63", "a1e1", "0pe7"],
 ["jj67", "86k1", "1k86"], ["ke16", "a1f0", "0pf6"], ["dj72", "86l0", "3a0d"],
 ["jj76", "31j2", "2f6d"], ["dj81", "a1j6", "1kdd"], ["ee30", "26p2", "0pjd"],
 ["dja0", "31k1", "6q03"], ["8803", "26q1", "dq07"], ["f807", "31l0", "6q12"],
 ["7e63", "26r0", "dq16"], ["8812", "31p6", "6q21"], ["f816", "26u6", "6q30"],
 ["6jd3", "vd01", "1l03"], ["7e72", "1d0r", "7l07"], ["ee76", "7d0u", "0q63"],
 ["6je2", "vd10", "1l12"], ["dje6", "1d1q", "7l16"], ["8830", "1d2p", "0q72"],
 ["6jf1", "r701", "6q76"], ["7ea0", "270u", "0q81"], ["6jg0", "qd61", "1l30"],
 ["3303", "r710", "0qa0"], ["a307", "1d6u", "2g07"], ["2863", "qd70", "1l67"],
 ["3312", "m201", "2g16"], ["a316", "l761", "0qd7"], ["1ed3", "m210", "1l76"],
 ["2872", "kdd1", "0qe6"], ["8876", "l770", "6r02"], ["0jj3", "kde0", "dr06"],
 ["1ee2", "g261", "6r11"], ["7ee6", "f7d1", "6r20"], ["3330", "g270", "1m02"],
 ["0jk2", "edj1", "7m06"], ["6jk6", "f7e0", "0r62"], ["28a0", "edk0", "1m11"],
 ["0jl1", "a2d1", "0r71"], ["3367", "87j1", "1m20"], ["28d7", "a2e0", "0r80"],
 ["3376", "7dp1", "2h06"], ["1ej7", "87k0", "1m66"], ["28e6", "7dq0", "0rd6"],
 ["0jp7", "32j1", "6s01"], ["1ek6", "27p1", "6s10"], ["0jq6", "32k0", "1n01"],
 ["jk02", "1du1", "0s61"], ["pk06", "27q0", "1n10"], ["jk11", "1dv0", "0s70"],
 ["jk20", "0j0m", "500k"], ["ef02", "6j0q", "501j"], ["kf06", "0j1l", "460f"],
 ["dk62", "6j1p", "b60j"], ["jk66", "0j2k", "461e"], ["dk71", "0j3j", "462d"],
 ["ef20", "ve00", "510j"], ["dk80", "1e0q", "466j"], ["8a02", "uj60", "3d0a"],
 ["fa06", "0j6q", "ad0e"], ["7f62", "1e1p", "3d18"], ["8a11", "0j7p", "ad1d"],
 ["6kd2", "r800", "3d27"], ["7f71", "qe60", "3d36"], ["8a20", "pjd0", "470e"],
 ["6ke1", "m300", "3d6e"], ["7f80", "l860", "471d"], ["6kf0", "ked0", "3d7d"],
 ["3402", "jjj0", "2j04"], ["a406", "g360", "8j08"], ["2a62", "f8d0", "fj0d"],
 ["8a66", "eej0", "2j13"], ["1fd2", "djp0", "8j17"], ["2a71", "a3d0", "2j22"],
 ["3420", "88j0", "8j26"], ["0kj2", "7ep0", "2j31"], ["1fe1", "6ju0", "2j40"],
 ["2a80", "33j0", "3e08"], ["0kk1", "28p0", "ae0d"], ["1ff0", "1eu0", "2j68"],
 ["0kl0", "0k0l", "8j6d"], ["2ad6", "6k0p", "2j77"], ["0kp6", "0k1k", "3e26"],
 ["jl10", "0k2j", "2j86"], ["dl61", "1f0p", "480d"], ["dl70", "0k6p", "3e6d"],
 ["7g61", "0l0k", "2jdd"], ["6ld1", "0l1j", "7p03"], ["6le0", "0m0j", "ep07"],
 ["2b61", "n002", "7p12"], ["1gd1", "n011", "ep16"], ["0lj1", "n020", "7p21"],
 ["0lk0", "h062", "7p30"], ["4005", "n066", "2k03"], ["4014", "h071", "8k07"],
 ["b018", "h080", "1p63"], ["4023", "b0d2", "7p67"], ["4032", "h0d6", "8k16"],
 ["4041", "b0e1", "1p72"], ["406a", "b0f0", "2k21"], ["4078", "40j2", "1p81"],
 ["4087", "b0j6", "2k30"], ["40a6", "40k1", "1pa0"], ["40de", "40l0", "3f07"],
 ["40ed", "40p6", "2k67"], ["a604", "s601", "3f16"], ["a613", "360u", "1pd7"],
 ["g617", "s610", "2k76"], ["a622", "n101", "1pe6"], ["g626", "m661", "du02"],
 ["a631", "n110", "ju06"], ["a640", "m670", "du11"], ["4104", "h161", "du20"],
 ["b108", "g6d1", "7q02"], ["3664", "h170", "eq06"], ["a668", "g6e0", "6u62"],
 ["b117", "b1d1", "7q11"], ["3673", "a6j1", "6u71"], ["a677", "b1e0", "7q20"],
 ["3682", "a6k0", "6u80"], ["a686", "41j1", "2l02"], ["36a1", "36p1", "8l06"],
 ["4140", "41k0", "1q62"], ["36b0", "36q0", "2l11"], ["4168", "wd00", "0ud2"],
 ["b16d", "2d0q", "1q71"], ["36d8", "2d1p", "2l20"], ["a6dd", "s700", "0ue1"],
 ["36e7", "rd60", "1q80"], ["4186", "n200", "0uf0"], ["36f6", "m760", "3g06"],
 ["41dd", "ldd0", "2l66"], ["36jd", "h260", "1qd6"], ["fd03", "g7d0", "0uj6"],
 ["fd12", "fdj0", "dv01"], ["fd21", "b2d0", "dv10"], ["fd30", "a7j0", "7r01"],
 ["a703", "8dp0", "6v61"], ["8d63", "42j0", "7r10"], ["fd67", "37p0", "6v70"],
 ["g716", "2du0", "2m01"], ["8d72", "1j0l", "1r61"], ["fd76", "7j0p", "2m10"],
 ["8d81", "1j1k", "0vd1"], ["a730", "1j2j", "1r70"], ["8da0", "2e0p", "0ve0"],
 ["4203", "1j6p", "dw00"], ["3763", "0p0g", "7s00"], ["4212", "6p0k", "6w60"],
 ["b216", "0p1f", "2n00"], ["2dd3", "6p1j", "1s60"], ["3772", "0p2e", "0wd0"],
 ["4221", "0p3d", "560e"], ["2de2", "1k0k", "561d"], ["3781", "0p6k", "4d08"],
 ["4230", "1k1j", "bd0d"], ["2df1", "0p7j", "4d17"], ["37a0", "0q0f", "4d26"],
 ["4267", "6q0j", "570d"], ["37d7", "0q1e", "4d6d"], ["4276", "0q2d", "3j03"],
 ["2dj7", "1l0j", "aj07"], ["37e6", "0q6j", "3j12"], ["2dk6", "0r0e", "aj16"],
 ["kj02", "0r1d", "3j21"], ["kj11", "0s0d", "3j30"], ["kj20", "i061", "4e07"],
 ["fe02", "i070", "3j67"], ["ej62", "c0d1", "4e16"], ["kj66", "c0e0", "3j76"],
 ["ej71", "50j1", "8p02"], ["fe20", "50k0", "fp06"], ["ej80", "n660", "8p11"],
 ["a802", "i160", "8p20"], ["g806", "h6d0", "3k02"], ["8e62", "c1d0", "ak06"],
 ["fe66", "b6j0", "2p62"], ["7jd2", "51j0", "8p66"], ["8e71", "46p0", "2p71"],
 ["a820", "3d0p", "3k20"], ["7je1", "2j0k", "2p80"], ["8e80", "2j1j", "4f06"],
 ["7jf0", "1p0f", "3k66"], ["4302", "7p0j", "2pd6"], ["b306", "1p1e", "eu01"],
 ["3862", "1p2d", "eu10"], ["a866", "2k0j", "8q01"], ["2ed2", "1p6j", "7u61"],
 ["3871", "0u0a", "8q10"], ["4320", "6u0e", "7u70"], ["1jj2", "0u18", "3l01"],
 ["2ee1", "6u1d", "2q61"], ["3880", "0u27", "3l10"], ["1jk1", "0u36", "1ud1"],
 ["2ef0", "1q0e", "2q70"], ["4366", "0u6e", "1ue0"], ["38d6", "1q1d", "ev00"],
 ["2ej6", "0u7d", "8r00"], ["1jp6", "0v08", "7v60"], ["pp01", "6v0d", "3m00"],
 ["pp10", "0v17", "2r60"], ["kk01", "0v26", "1vd0"], ["jp61", "1r0d", "5d07"],
 ["kk10", "0v6d", "5d16"], ["jp70", "0w07", "4j02"], ["ff01", "0w16", "bj06"],
 ["ek61", "3j0j", "4j11"], ["ff10", "2p0e", "4j20"], ["dpd1", "2p1d", "5e06"],
 ["ek70", "1u08", "4j66"], ["dpe0", "7u0d", "ap01"], ["aa01", "1u17", "ap10"],
 ["8f61", "1u26", "4k01"], ["aa10", "2q0d", "3p61"], ["7kd1", "1u6d", "4k10"],
 ["8f70", "1v07", "3p70"], ["6pj1", "1v16", "fu00"]]

errcoef = [[27, 917],
[522, 568, 723, 809],
[237, 308, 436, 284, 646, 653, 428, 379],
[274, 562, 232, 755, 599, 524, 801, 132, 295, 116, 442, 428, 295,
 42, 176, 65],
[361, 575, 922, 525, 176, 586, 640, 321, 536, 742, 677, 742, 687,
 284, 193, 517, 273, 494, 263, 147, 593, 800, 571, 320, 803, 133, 231, 390,
 685, 330, 63, 410],
[539, 422, 6, 93, 862, 771, 453, 106, 610, 287, 107, 505, 733,
 877, 381, 612, 723, 476, 462, 172, 430, 609, 858, 822, 543, 376, 511, 400,
 672, 762, 283, 184, 440, 35, 519, 31, 460, 594, 225, 535, 517, 352, 605, 158,
 651, 201, 488, 502, 648, 733, 717, 83, 404, 97, 280, 771, 840, 629, 4, 381,
 843, 623, 264, 543],
[521, 310, 864, 547, 858, 580, 296, 379, 53, 779, 897, 444, 400,
 925, 749, 415, 822, 93, 217, 208, 928, 244, 583, 620, 246, 148, 447, 631, 292,
 908, 490, 704, 516, 258, 457, 907, 594, 723, 674, 292, 272, 96, 684, 432, 686,
 606, 860, 569, 193, 219, 129, 186, 236, 287, 192, 775, 278, 173, 40, 379, 712,
 463, 646, 776, 171, 491, 297, 763, 156, 732, 95, 270, 447, 90, 507, 48, 228,
 821, 808, 898, 784, 663, 627, 378, 382, 262, 380, 602, 754, 336, 89, 614, 87,
 432, 670, 616, 157, 374, 242, 726, 600, 269, 375, 898, 845, 454, 354, 130,
 814, 587, 804, 34, 211, 330, 539, 297, 827, 865, 37, 517, 834, 315, 550, 86,
 801, 4, 108, 539],
[524, 894, 75, 766, 882, 857, 74, 204, 82, 586, 708, 250, 905,
 786, 138, 720, 858, 194, 311, 913, 275, 190, 375, 850, 438, 733, 194, 280,
 201, 280, 828, 757, 710, 814, 919, 89, 68, 569, 11, 204, 796, 605, 540, 913,
 801, 700, 799, 137, 439, 418, 592, 668, 353, 859, 370, 694, 325, 240, 216,
 257, 284, 549, 209, 884, 315, 70, 329, 793, 490, 274, 877, 162, 749, 812, 684,
 461, 334, 376, 849, 521, 307, 291, 803, 712, 19, 358, 399, 908, 103, 511, 51,
 8, 517, 225, 289, 470, 637, 731, 66, 255, 917, 269, 463, 830, 730, 433, 848,
 585, 136, 538, 906, 90, 2, 290, 743, 199, 655, 903, 329, 49, 802, 580, 355,
 588, 188, 462, 10, 134, 628, 320, 479, 130, 739, 71, 263, 318, 374, 601, 192,
 605, 142, 673, 687, 234, 722, 384, 177, 752, 607, 640, 455, 193, 689, 707,
 805, 641, 48, 60, 732, 621, 895, 544, 261, 852, 655, 309, 697, 755, 756, 60,
 231, 773, 434, 421, 726, 528, 503, 118, 49, 795, 32, 144, 500, 238, 836, 394,
 280, 566, 319, 9, 647, 550, 73, 914, 342, 126, 32, 681, 331, 792, 620, 60,
 609, 441, 180, 791, 893, 754, 605, 383, 228, 749, 760, 213, 54, 297, 134, 54,
 834, 299, 922, 191, 910, 532, 609, 829, 189, 20, 167, 29, 872, 449, 83, 402,
 41, 656, 505, 579, 481, 173, 404, 251, 688, 95, 497, 555, 642, 543, 307, 159,
 924, 558, 648, 55, 497, 10],
[352, 77, 373, 504, 35, 599, 428, 207, 409, 574, 118, 498, 285,
 380, 350, 492, 197, 265, 920, 155, 914, 299, 229, 643, 294, 871, 306, 88, 87,
 193, 352, 781, 846, 75, 327, 520, 435, 543, 203, 666, 249, 346, 781, 621, 640,
 268, 794, 534, 539, 781, 408, 390, 644, 102, 476, 499, 290, 632, 545, 37, 858,
 916, 552, 41, 542, 289, 122, 272, 383, 800, 485, 98, 752, 472, 761, 107, 784,
 860, 658, 741, 290, 204, 681, 407, 855, 85, 99, 62, 482, 180, 20, 297, 451,
 593, 913, 142, 808, 684, 287, 536, 561, 76, 653, 899, 729, 567, 744, 390, 513,
 192, 516, 258, 240, 518, 794, 395, 768, 848, 51, 610, 384, 168, 190, 826, 328,
 596, 786, 303, 570, 381, 415, 641, 156, 237, 151, 429, 531, 207, 676, 710, 89,
 168, 304, 402, 40, 708, 575, 162, 864, 229, 65, 861, 841, 512, 164, 477, 221,
 92, 358, 785, 288, 357, 850, 836, 827, 736, 707, 94, 8, 494, 114, 521, 2, 499,
 851, 543, 152, 729, 771, 95, 248, 361, 578, 323, 856, 797, 289, 51, 684, 466,
 533, 820, 669, 45, 902, 452, 167, 342, 244, 173, 35, 463, 651, 51, 699, 591,
 452, 578, 37, 124, 298, 332, 552, 43, 427, 119, 662, 777, 475, 850, 764, 364,
 578, 911, 283, 711, 472, 420, 245, 288, 594, 394, 511, 327, 589, 777, 699,
 688, 43, 408, 842, 383, 721, 521, 560, 644, 714, 559, 62, 145, 873, 663, 713,
 159, 672, 729, 624, 59, 193, 417, 158, 209, 563, 564, 343, 693, 109, 608, 563,
 365, 181, 772, 677, 310, 248, 353, 708, 410, 579, 870, 617, 841, 632, 860,
 289, 536, 35, 777, 618, 586, 424, 833, 77, 597, 346, 269, 757, 632, 695, 751,
 331, 247, 184, 45, 787, 680, 18, 66, 407, 369, 54, 492, 228, 613, 830, 922,
 437, 519, 644, 905, 789, 420, 305, 441, 207, 300, 892, 827, 141, 537, 381,
 662, 513, 56, 252, 341, 242, 797, 838, 837, 720, 224, 307, 631, 61, 87, 560,
 310, 756, 665, 397, 808, 851, 309, 473, 795, 378, 31, 647, 915, 459, 806, 590,
 731, 425, 216, 548, 249, 321, 881, 699, 535, 673, 782, 210, 815, 905, 303,
 843, 922, 281, 73, 469, 791, 660, 162, 498, 308, 155, 422, 907, 817, 187, 62,
 16, 425, 535, 336, 286, 437, 375, 273, 610, 296, 183, 923, 116, 667, 751, 353,
 62, 366, 691, 379, 687, 842, 37, 357, 720, 742, 330, 5, 39, 923, 311, 424,
 242, 749, 321, 54, 669, 316, 342, 299, 534, 105, 667, 488, 640, 672, 576, 540,
 316, 486, 721, 610, 46, 656, 447, 171, 616, 464, 190, 531, 297, 321, 762, 752,
 533, 175, 134, 14, 381, 433, 717, 45, 111, 20, 596, 284, 736, 138, 646, 411,
 877, 669, 141, 919, 45, 780, 407, 164, 332, 899, 165, 726, 600, 325, 498, 655,
 357, 752, 768, 223, 849, 647, 63, 310, 863, 251, 366, 304, 282, 738, 675, 410,
 389, 244, 31, 121, 303, 263]]

alpha_val = {"A": 0, "B": 1, "C": 2, "D": 3, "E": 4, "F": 5, "G": 6, "H": 7,
   "I": 8, "J": 9, "K": 10, "L": 11, "M": 12, "N": 13, "O": 14, "P": 15,
   "Q": 16, "R": 17, "S": 18, "T": 19, "U": 20, "V": 21, "W": 22, "X": 23,
   "Y": 24, "Z": 25, " ": 26, "ll": 27, "ml": 28, "ps": 29}
lower_val = {"a": 0, "b": 1, "c": 2, "d": 3, "e": 4, "f": 5, "g": 6, "h": 7,
    "i": 8, "j": 9, "k": 10, "l": 11, "m": 12, "n": 13, "o": 14, "p": 15,
    "q": 16, "r": 17, "s": 18, "t": 19, "u": 20, "v": 21, "w": 22, "x": 23,
    "y": 24, "z": 25, " ": 26, "as": 27, "ml": 28, "ps": 29}
mixed_val = {"0": 0, "1": 1, "2": 2, "3": 3, "4": 4, "5": 5, "6": 6, "7": 7,
    "8": 8, "9": 9, "&": 10, "\r": 11, "\t": 12, ",": 13, ":": 14,
    "#": 15, "-": 16, ".": 17, "$": 18, "/": 19, "+": 20,
    "%": 21, "*": 22, "=": 23, "^": 24, "pl": 25, " ": 26,
    "ll": 27, "al": 28, "ps": 29}
punctuation_val= {";": 0, "<": 1, ">": 2, "@": 3, "[": 4, "\\": 5,
    "]": 6, "_": 7, "`": 8, "~": 9, "!": 10, "\r": 11, "\t": 12,
    ",": 13, ":": 14, "\n": 15, "-": 16, ".": 17, "\$": 18,
    "/": 19, "\"": 20, "|": 21, "*": 22, "(": 23, ")": 24,
    "?": 25, "{": 26, "}": 27, "'": 28, "al": 29}

def pdf417_codewords(string):
    """Generates PDF417 codewords.

    Parameter:
        string: The text to generate the codewords from
    """
    prev = ALPHA
    codewords = []
    text = []
    for match in re.findall("([A-Z ]+)|([a-z ]+)|([0-9&\r\t,:#.\$\/+%*=^ -]+)|([;<>\@_`~!\r\t,:\n.\$\/\"|\*()?{}'\\]\\[\\\\-]+)|([\000-\010\013\014\016-\037\177-\377]+)", string):
	if match[0] != '':
	    type = ALPHA
	    if prev == LOWER:
		if len(match[0]) == 1:
		    text.append(lower_val['as'])
		    type = LOWER
		else:
		    text.extend((lower_val['ml'], mixed_val['al']))
	    elif prev == MIXED:
		text.append(mixed_val['al'])
	    elif prev == PUNCTUATION:
		text.append(punctuation_val['al'])
	    elif prev == NUMERIC or prev == BYTE:
		codewords.append(TEXTLATCH)
	    for char in match[0]:
		text.append(alpha_val[char])
	if match[1] != '':
	    type = LOWER
	    if prev == ALPHA:
		text.append(alpha_val['ll'])
	    elif prev == MIXED:
		text.append(mixed_val['ll'])
	    elif prev == PUNCTUATION:
		text.extend((punctuation_val['al'], alpha_val['ll']))
	    elif prev == NUMERIC or prev == BYTE:
		codewords.append(TEXTLATCH)
		text.append(alpha_val['ll'])
	    for char in match[1]:
		text.append(lower_val[char])
	if match[2] != '':
	    mixed = re.split(r'(\d{13,})', match[2])
	    while mixed:
		m = mixed[0]
		mixed = mixed[1:]
		if m != '':
		    type = MIXED
		    if prev == ALPHA:
			text.append(alpha_val['ml'])
		    elif prev == LOWER:
			text.append(lower_val['ml'])
		    elif prev == PUNCTUATION:
			text.extend((punctuation_val['al'], alpha_val['ml']))
		    elif prev == NUMERIC or prev == BYTE:
			codewords.append(TEXTLATCH)
			text.append(alpha_val['ml'])
		    for char in m:
			text.append(mixed_val[char])
		if mixed:
		    type = NUMERIC
		    if text:
			if len(text) % 2 == 1:
			    text.append(29)
			codewords.extend(textcodes(text))
			text = []
		    codewords.append(NUMERICLATCH)
		    digits = mixed.pop(0)
		    for dig in re.findall(r"\d{1,44}", match[2]):
			c = []
			temp = "1" + dig
			while temp:
			    (temp, rem) = divmod(int(temp), 900)
			    c.insert(0, int(rem))
			codewords.extend(c)
		    prev = NUMERIC
	if match[3] != '':
	    type = PUNCTUATION
	    if prev == NUMERIC or prev == BYTE:
		codewords.append(TEXTLATCH)
		prev = ALPHA
	    if prev == ALPHA:
		if len(match[3]) == 1:
		    text.append(alpha_val['ps'])
		    type = ALPHA
		else:
		    text.extend((alpha_val['ml'], mixed_val['pl']))
	    elif prev == LOWER:
		if len(match[3]) == 1:
		    text.append(lower_val['ps'])
		else:
		    text.extend((lower_val['ml'], mixed_val['pl']))
	    elif prev == MIXED:
		if len(match[3]) == 1:
		    text.append(mixed_val['ps'])
		else:
		    text.append(mixed_val['pl'])
	    for char in match[3]:
		text.append(punctuation_val[char])
	    if len(match[3]) == 1:
		type = prev
	if match[4] != '':
	    if text:
		if len(text) % 2 == 1:
		    text.append(29)
		codewords.extend(textcodes(text))
		text = []
	    if len(match[4])== 1 and prev != NUMERIC:
		codewords.extend((BYTESHIFT, ord(match[4])))
		type = ALPHA
	    else:
		type = BYTE
		if len(match[4]) % 6:
		    codewords.append(BYTELATCH)
		else:
		    codewords.append(BYTELATCH2)
		for b in re.findall(r".{1,6}", match[4]):
		    if len(b) == 6:
			c = []
			c.extend(map(ord, b))
			temp = c[0]
			for i in range(1, 6):
			    temp *= 256
			    temp += c[i]
			c = []
			for i in range(1, 6):
			    (temp, rem) = divmod(int(temp), 900)
			    c.insert(0, int(rem))
			codewords.extend(c)
		    else:
			codewords.extend(map(ord, b))
	prev = type
    if text:
	if len(text) % 2 == 1:
	    text.append(29)
	codewords.extend(textcodes(text))
    return codewords

def pdf417_text(codewords, rows, cols, errlevel):
    """Generates the the text to be printed using the PDF417JK font.

    Parameters:
        codewords: T
        rows:      Number of rows in the PDF417 symbol, 0 means compute it.
        cols:      Number of columns in the PDF417 symbol, 0 means compute it.
        errlevel:  Error correction leve, 0 <= errlevel <= 8.
    """
    k = 2**(errlevel+1)
    m = len(codewords)
    if rows == 0:
	rows = ceil(float(m+k+1)/cols)
    if cols == 0:
	cols = ceil(float(m+k+1)/rows)
    pad = rows*cols - m - k - 1
    codewords.extend([900] * pad)
    codewords.insert(0, len(codewords)+1)

    errorwords = [0] * k
    for i in range(len(codewords)):
	temp1 = (codewords[i] + errorwords[k-1]) % 929
	for j in range(k-1,0,-1):
	    temp2 = (temp1*errcoef[errlevel][j]) % 929
	    temp3 = 929 - temp2
	    errorwords[j] = (errorwords[j-1] + temp3) % 929
	temp2 = (temp1*errcoef[errlevel][0]) % 929
	temp3 = 929 - temp2
	errorwords[0] = temp3 % 929
    for j in range(k-1,-1,-1):
	if errorwords[j] != 0:
	    errorwords[j] = 929 - errorwords[j]
	codewords.append(errorwords[j])
    lines = ''
    for i in range(rows):
	if i % 3 == 0:
	    left = 30*(i/3) + (rows-1)/3
	    right = 30*(i/3) + cols - 1
	elif i % 3 == 1:
	    left = 30*(i/3) + 3*errlevel + (rows-1) % 3
	    right = 30*(i/3) + (rows-1)/3
	else:
	    left = 30*(i/3) + cols - 1
	    right = 30*(i/3) + 3*errlevel + (rows-1) % 3
	temp = ""
	for j in range(cols):
	    code = codewords.pop(0)
	    temp += codes[code][i % 3]
	lines += "y" + codes[left][i % 3] + temp + codes[right][i % 3] + "z\n"
    return lines
